<!DOCTYPE html>
<html
    xmlns:th="http://www.thymeleaf.org"
    lang="ko"
>
    <head>
        <meta charset="UTF-8" />
        <title>회원가입 • 실습 프로젝트</title>
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1"
        />
        <!-- 캐시 무력화된 공용 CSS (있으면 로드됨) -->
        <link
            rel="stylesheet"
            th:href="@{/css/main.css(v=${#dates.createNow().time})}"
        />
        <style>
            body {
                font-family: system-ui, -apple-system, Segoe UI, Roboto, Apple SD Gothic Neo, Malgun Gothic, sans-serif;
                background: #f6f8fb;
                margin: 0;
            }
            .topbar {
                background: #3498db;
                color: #fff;
                padding: 12px 16px;
            }
            .brand {
                font-weight: 700;
            }
            main.card {
                background: #fff;
                max-width: 520px;
                margin: 28px auto;
                padding: 22px 22px 26px;
                border-radius: 14px;
                box-shadow: 0 10px 30px rgba(31, 38, 135, 0.08);
            }
            h1 {
                margin: 0.2rem 0 0.4rem;
            }
            .hint {
                color: #555;
                font-size: 14px;
            }
            form {
                display: grid;
                grid-template-columns: 1fr;
                gap: 10px;
                margin-top: 12px;
            }
            label {
                font-weight: 600;
                font-size: 14px;
            }
            input {
                padding: 10px 12px;
                border: 1px solid #cfd7e3;
                border-radius: 10px;
                font-size: 15px;
            }
            .btn-primary {
                padding: 10px 14px;
                border: 0;
                border-radius: 10px;
                background: #3498db;
                color: #fff;
                font-weight: 700;
                cursor: pointer;
            }
            .btn-primary:hover {
                background: #2c63ca;
            }
            .error {
                background: #ffebee;
                color: #c62828;
                border: 1px solid #ef9a9a;
                padding: 10px;
                border-radius: 10px;
            }
            a {
                color: #3478f6;
                text-decoration: none;
            }
        </style>
    </head>
    <body>
        <header class="topbar">
            <div class="brand">실습 프로젝트</div>
        </header>

        <main class="card">
            <h1>회원가입</h1>
            <p class="hint">필수 항목을 입력해 계정을 생성하세요.</p>

            <!-- 오류 메시지: AuthController가 redirect:/signup?error=... 로 세팅 -->
            <div th:if="${param.error}">
                <p
                    class="error"
                    th:switch="${param.error}"
                >
                    <span th:case="'invalid_userId'">아이디 형식을 확인해 주세요. (영문/숫자/_ 최대 16자)</span>
                    <span th:case="'invalid_password'">비밀번호를 4자 이상 입력해 주세요.</span>
                    <span th:case="'invalid_name'">이름을 입력해 주세요.</span>
                    <span th:case="'invalid_email'">올바른 이메일을 입력해 주세요.</span>
                    <span th:case="'conflict'">이미 사용 중인 아이디 또는 이메일입니다.</span>
                    <span th:case="'server'">서버 오류가 발생했습니다. 잠시 후 다시 시도해 주세요.</span>
                    <span th:case="*">요청 처리에 실패했습니다.</span>
                </p>
            </div>

            <!-- ✅ 백엔드(AuthController) 파라미터명과 정확히 일치 -->
            <!--    userId, password, name, email, phone -->
            <form
                th:action="@{/signup}"
                method="post"
                autocomplete="off"
            >
                <!-- CSRF 보호: 반드시 포함 -->
                <input
                    type="hidden"
                    th:name="${_csrf.parameterName}"
                    th:value="${_csrf.token}"
                />

                <label for="userId">아이디 (최대 16자) *</label>
                <input
                    id="userId"
                    name="userId"
                    type="text"
                    maxlength="16"
                    pattern="^[A-Za-z0-9_]{1,16}$"
                    title="영문/숫자/밑줄(_)만 허용, 최대 16자"
                    required
                    autofocus
                    placeholder="예: jhpark01"
                />

                <label for="name">이름 *</label>
                <input
                    id="name"
                    name="name"
                    type="text"
                    required
                    placeholder="예: 박지현"
                />

                <label for="email">이메일 *</label>
                <input
                    id="email"
                    name="email"
                    type="email"
                    required
                    placeholder="you@example.com"
                />

                <label for="phone">전화번호 (선택)</label>
                <input
                    id="phone"
                    name="phone"
                    type="tel"
                    placeholder="010-1234-5678"
                />

                <label for="password">비밀번호 *</label>
                <input
                    id="password"
                    name="password"
                    type="password"
                    minlength="4"
                    maxlength="60"
                    required
                    placeholder="4자 이상"
                />

                <div style="margin-top: 6px">
                    <button
                        type="submit"
                        class="btn-primary"
                    >
                        가입하기
                    </button>
                </div>
            </form>

            <p
                class="hint"
                style="margin-top: 12px"
            >
                이미 계정이 있나요? <a th:href="@{/login}">로그인</a>
            </p>
        </main>
    </body>
</html>
